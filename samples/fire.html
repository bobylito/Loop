<!doctype html>
<html>
<head>
<title>Xperience : animation playground</title>
<style type="text/css" media="screen">
/* <![CDATA[ */
*{padding:0;margin:0}
body{background-color:#000}

body{text-align:left; background-color:#111; color:#FFF; font-family:Verdana, Helvetica, Arial, Sans-serif; padding:35px 35px;}
ul li{list-style-type:none;}

/* ]]> */
</style>

</head>

<body>
  <div id="principal"> 
    <canvas id="scene" height="500" width="500"></canvas>
  </div>
</body>

<script src="../Stats.js" type="text/javascript" language="javascript" charset="utf-8"></script>
<script src="../lib.js" type="text/javascript" language="javascript" charset="utf-8"></script>
<script src="../particles.js" type="text/javascript" language="javascript" charset="utf-8"></script>
<script src="../bench.js" type="text/javascript" language="javascript" charset="utf-8"></script>
<script type="text/javascript" language="javascript" charset="utf-8">
(function(){
  var maxWithSign = function(val, max){
        return Math.min(Math.abs(val), max) * (Math.abs(val)/val);
      },
      fireFP = loop.animations.particle(
      function(){ return []; },
      function(now){
        return [  
          // x 
          Math.random() * datastore["CANVAS_WIDTH"],
          // y
          Math.random() * datastore["CANVAS_HEIGHT"] ,
          // Date d'expiration
          (new Date()).getTime() + 50000 ,
          // Valeur de déplacement sur x
          3 - Math.random() * 6,
          // Valeur de deplacement sur y
          3 - Math.random() * 6,
          // Début
          now
        ];
      },
      function(p){
        var xPrime = (p[0] - datastore["CANVAS_WIDTH"]/2),
            yPrime = (p[1] - datastore["CANVAS_HEIGHT"]/2),
            d = Math.sqrt(Math.pow(xPrime,2) + Math.pow(yPrime,2));
/*
        p[3] -= 10/Math.pow(d, 2) * (xPrime>0?1:-1);
        p[4] -= 10/Math.pow(d, 2) * (yPrime>0?1:-1);
        */

        p[3] = p[3] / Math.sin(d/20) * (xPrime>0?1:-1)/1.1;

        p[4] = p[4] / Math.sin(d/20) * (yPrime>0?1:-1)/1.1;


        return p;
      },
      {
        compositionMethod: "lighter",
        color : "hsl(230, 100%, 20%)", 
        size : 20
      });


  setTimeout(function(){
    fireFP.create(4000);
  }, 500)

  loop.registerAnimation(fireFP);
  loop.registerAnimation(loop.animations.particle.bench());

  loop.start();
})();
</script>
</html>
