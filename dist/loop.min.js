/*! loop 2014-01-02 */
var a=function(){var a=Date.now(),b=a,c=0,d=1e3,e=0,f=0,g=1e3,h=0,i=0,j=0,k=document.createElement("div");k.id="stats",k.addEventListener("mousedown",function(a){a.preventDefault(),s(++j%2)},!1),k.style.cssText="width:80px;opacity:0.9;cursor:pointer";var l=document.createElement("div");l.id="fps",l.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",k.appendChild(l);var m=document.createElement("div");m.id="fpsText",m.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",m.innerHTML="FPS",l.appendChild(m);var n=document.createElement("div");for(n.id="fpsGraph",n.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",l.appendChild(n);74>n.children.length;){var o=document.createElement("span");o.style.cssText="width:1px;height:30px;float:left;background-color:#113",n.appendChild(o)}var p=document.createElement("div");p.id="ms",p.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",k.appendChild(p);var q=document.createElement("div");q.id="msText",q.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",q.innerHTML="MS",p.appendChild(q);var r=document.createElement("div");for(r.id="msGraph",r.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",p.appendChild(r);74>r.children.length;)o=document.createElement("span"),o.style.cssText="width:1px;height:30px;float:left;background-color:#131",r.appendChild(o);var s=function(a){switch(j=a){case 0:l.style.display="block",p.style.display="none";break;case 1:l.style.display="none",p.style.display="block"}};return{domElement:k,setMode:s,begin:function(){a=Date.now()},end:function(){var j=Date.now();c=j-a,d=Math.min(d,c),e=Math.max(e,c),q.textContent=c+" MS ("+d+"-"+e+")";var k=Math.min(30,30-30*(c/200));return r.appendChild(r.firstChild).style.height=k+"px",i++,j>b+1e3&&(f=Math.round(1e3*i/(j-b)),g=Math.min(g,f),h=Math.max(h,f),m.textContent=f+" FPS ("+g+"-"+h+")",k=Math.min(30,30-30*(f/100)),n.appendChild(n.firstChild).style.height=k+"px",b=j,i=0),j},update:function(){a=this.end()}}};window.jsPlot=function(a,b,c){var d=Math.log(10),e={extend:c,createCanvas:function(a,c){var d=b.getElementById(a),e=d.getElementsByTagName("canvas")[0];return e||(e=b.createElement("canvas"),d.appendChild(e)),e.width=c.canvasWidth,e.height=c.canvasHeight,e.getContext("2d")},findNiceRoundStep:function(a,b){var c=a/b,e=Math.floor(Math.log(c)/d),f=Math.pow(10,e),c=c/f;return 1.5>c?c=1:3.5>c?c=2:7.5>c?c=5:(f=Math.pow(10,e+1),c=1),c*f},drawAxes:function(a,b){a.save(),a.strokeStyle="#888",a.beginPath(),a.moveTo(b.Xmin*b.xscale,0),a.lineTo(b.Xmax*b.xscale,0),a.moveTo(0,b.Ymin*b.yscale),a.lineTo(0,b.Ymax*b.yscale),a.stroke(),a.fillStyle="black",a.beginPath(),a.moveTo(b.Xmax*b.xscale,0),a.lineTo(b.Xmax*b.xscale-10,6),a.lineTo(b.Xmax*b.xscale-10,-6),a.lineTo(b.Xmax*b.xscale,0),a.moveTo(0,b.Ymax*b.yscale),a.lineTo(-6,b.Ymax*b.yscale-10),a.lineTo(6,b.Ymax*b.yscale-10),a.lineTo(0,b.Ymax*b.yscale),a.fill(),a.scale(-1,1),a.font="13px helvetica",a.textAlign="end",a.textBaseline="bottom",a.rotate(Math.PI),a.save(),a.translate(b.Xmax*b.xscale-13,-2),a.fillText(b.xLabel,0,0),a.restore(),a.rotate(-Math.PI/2),a.translate(b.Ymax*b.yscale-13,-2),a.fillText(b.yLabel,0,0),a.restore()},drawGrid:function(a,b){var c=e.findNiceRoundStep(b.Xmax-b.Xmin,15);a.save(),a.font="15px helvetica",a.strokeStyle="#CCF",a.lineWidth=1,a.beginPath();for(var d=b.Xmin-b.Xmin%c;d<b.Xmax;d+=c)a.moveTo(d*b.xscale,b.Ymin*b.yscale),a.lineTo(d*b.xscale,b.Ymax*b.yscale);for(a.stroke(),a.beginPath(),d=b.Ymin-b.Ymin%c;d<b.Ymax;d+=c)a.moveTo(b.Xmin*b.xscale,d*b.yscale),a.lineTo(b.Xmax*b.xscale,d*b.yscale);for(a.stroke(),a.save(),a.rotate(-Math.PI),a.scale(-1,1),d=b.Xmin-b.Xmin%(2*c);d<b.Xmax;d+=2*c)a.fillText(Math.round(1e6*d)/1e6,d*b.xscale,0);for(a.rotate(-Math.PI/2),d=b.Ymin-b.Ymin%(2*c);d<b.Ymax;d+=2*c){var f=Math.round(1e6*d)/1e6;0!==f&&a.fillText(f,d*b.yscale,0)}a.restore(),a.restore()},drawFunction:function(a,b,c){try{var d=b.Xmin*b.xscale,e=b.Xmax*b.xscale,f=a.strokeStyle,g=c.color?c.color:"#000";for(a.lineWidth=c.width?c.width:1,a.strokeStyle=g,a.moveTo(d,c(d)),a.beginPath();e>=d;d++){var h=c(d/b.xscale),h=h<b.Ymin?b.Ymin-1:h,h=h>b.Ymax?b.Ymax+1:h;a.lineTo(d,h*b.yscale)}a.stroke()}catch(i){}finally{a.stokeStyle=f}}},f={Xmin:0,Xmax:10,Ymin:0,Ymax:3,xLabel:"x",yLabel:"y",canvasHeight:500,canvasWidth:500,gridVisible:!0},a=function(a,b,c){var b=e.extend({},f,b),d=b.X=b.Xmax-b.Xmin,g=b.Y=b.Ymax-b.Ymin,d=b.xscale=b.canvasWidth/d,g=b.yscale=b.canvasHeight/g,a=e.createCanvas(a,b);for(a.scale(1,-1),a.translate(0,-b.canvasHeight),a.translate(-(b.Xmin*d),-(b.Ymin*g)),b.gridVisible&&e.drawGrid(a,b),e.drawAxes(a,b),d=0;d<c.length;d++)e.drawFunction(a,b,c[d])};return a.tools={datasetToFunc:function(a){return a.reduce(function(a,b,c,d){if(c=d[c+1],void 0===c)return function(c){return c>b[0]?void 0:a(c)};var e=(c[1]-b[1])/(c[0]-b[0]),f=b[1]-e*b[0],g=b[0];return function(b){return b>=g?e*b+f:a(b)}},function(){})},funcToDataset:function(a,b){for(var c=e.findNiceRoundStep(b.Xmax-b.Xmin,15),d=[],f=b.Xmin-b.Xmin%c;f<b.Xmax;f+=c)d.push(a(f));return d}},a}(window,document,function(a){return[].slice.call(arguments,1).forEach(function(b){for(key in b)a[key]=b[key]}),a}),function(a,b){b.particles=function(){var a=document.createElement("div");return a.innerHTML=0,document.body.appendChild(a),{_init:function(a,b){var c=this;b.on("start",function(){c.pf=b._animations.filter(function(a){return!!a.getParticleCount})})},animate:function(){return!0},render:function(){a.innerHTML=this.pf.reduce(function(a,b){return a+b.getParticleCount()},0)}}}}(window.Loop=window.Loop||{},window.Loop.benchmark=window.Loop.benchmark||{}),function(a){function b(a){this.eventRegister={},this._animations=[],this._io=[],this._out={},this.status=null,this.stats=function(){var a=new d;return a.domElement&&(a.domElement.style.position="absolute",a.domElement.style.right="0px",a.domElement.style.top="0px",document.body.appendChild(a.domElement)),a}(),a.forEach(this._addOutput.bind(this)),this.loop=this.loop.bind(this)}var c=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),d=window.Stats||function(){this.setMode=function(){},this.begin=function(){},this.end=function(){}};return b.prototype={loop:function(){this.status&&c(this.loop);var a=this.calculateIOState();this.stats.begin();for(var b=this._animations.length-1;b>=0;b--)this._animations[b].animate(a)||this._animations.splice(b,1);this._trigger("renderStart");for(var d=0;d<this._animations.length;d++)this._animations[d].render(this._out);this._trigger("renderEnd"),this.stats.end()},start:function(){this._trigger("start"),this.status=!0,this.loop()},stop:function(){this._trigger("stop"),this.status=!1},registerAnimation:function(a){"function"==typeof a._init&&a._init(this._out,this,this.calculateIOState()),this._animations.push(a)},addIO:function(a){if(!a._init)throw console.log("Wrong IOManager : ",a),new Error("IOmanagers should have _init method");a._init(this._out),this._io.push(a)},_addOutput:function(a){if(!a._init)throw console.log("Wrong OutputManager : ",a),new Error("OutputManagers should have _init method");this._out[a.name]=a._init(this)},calculateIOState:function(){return this._io.map(function(a){return a.update}).reduce(function(a,b){return b(a)},{})},on:function(a,b){void 0===this.eventRegister[a]&&(this.eventRegister[a]=[]),this.eventRegister[a].push(b)},_trigger:function(a){if(this.eventRegister[a]){var b=this,c=this.eventRegister[a];if(!c||!c.length)return;for(var d=c.length-1;d>=0;d--)c[d].call(b)}}},a.create=function(){if(arguments.length<1)throw new Error("No output managers provided.");var a=Array.prototype.splice.call(arguments,0);return new b(a)},b}(window.Loop=window.Loop||{},window.Loop.animations=window.Loop.animations||{}),function(a,b){var c=" attribute vec2 a_position;  void main() { gl_Position = vec4(a_position, 0, 1);}",d=function(a){return{glCanvas:document.createElement("canvas"),_init:function(b){var d,e=b.canvas2d.parameters.width,f=b.canvas2d.parameters.height;this.glCanvas.width=e,this.glCanvas.height=f;var g=this.glContext=this.glCanvas.getContext("experimental-webgl");g.viewport(0,0,e,f);var h=g.createShader(g.VERTEX_SHADER);g.shaderSource(h,c),g.compileShader(h),d=g.getShaderParameter(h,g.COMPILE_STATUS),d||(lastError=g.getShaderInfoLog(h),console.log("*** Error compiling vertexShader '"+h+"':"+lastError));var i=g.createShader(g.FRAGMENT_SHADER);g.shaderSource(i,a),g.compileShader(i),d=g.getShaderParameter(i,g.COMPILE_STATUS),d||(lastError=g.getShaderInfoLog(i),console.log("*** Error compiling fragShader '"+i+"':"+lastError));var j=g.createProgram();g.attachShader(j,h),g.attachShader(j,i),g.linkProgram(j),g.useProgram(j);var k=g.getAttribLocation(j,"a_position"),l=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,l),g.bufferData(g.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),g.STATIC_DRAW),g.enableVertexAttribArray(k),g.vertexAttribPointer(k,2,g.FLOAT,!1,0,0),g.uniform1i(g.getUniformLocation(j,"u_canvas"),0)},animate:function(){return!0},render:function(a){var b=a.canvas2d.parameters.width,c=a.canvas2d.parameters.height,d=this.glContext,e=d.createTexture();d.bindTexture(d.TEXTURE_2D,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a.canvas2d.parameters.canvas),this.glContext.drawArrays(this.glContext.TRIANGLES,0,6),a.canvas2d.context.clearRect(0,0,b,c),a.canvas2d.context.drawImage(this.glCanvas,0,0,b,c)}}};b.glsl=d}(window.Loop=window.Loop||{},window.Loop.filters=window.Loop.filters||{}),function(a,b){function c(a,b){this.update=a.bind(this),this.variables=b}c.prototype={_init:function(a){this.el=a.canvas2d?a.canvas2d.parameters.canvas:document.body,this.elPos=this.el.getBoundingClientRect()}};var d=function(a){var b=new c(function(a){if(a.keys){var b=this._currentKeys();for(var c in b)a.keys[c]=b[c]}else a.keys=this._currentKeys();return a});b._keys={},b._inversedConfig={};for(var d in a)b._keys[d]=!1,b._inversedConfig[a[d]]=d;return b._currentKeys=function(){return document.addEventListener("keydown",function(a){var c=a.keyCode;c in b._inversedConfig&&(b._keys[b._inversedConfig[c]]=!0)}),document.addEventListener("keyup",function(a){var c=a.keyCode;c in b._inversedConfig&&(b._keys[b._inversedConfig[c]]=!1)}),b._currentKeys=function(){return this._keys},this._keys},b},e=function(a){var b=new c(function(a){if(a.keys){var b=this._currentKeys();for(var c in b)a.keys[c]=b[c]}else a.keys=this._currentKeys();return this._resetKeys(),a});b._keys={},b._firedKeys={},b._inversedConfig={};for(var d in a)b._keys[d]=!1,b._firedKeys[d]=!1,b._inversedConfig[a[d]]=d;return b._currentKeys=function(){return document.addEventListener("keydown",function(a){var c=a.keyCode;c in b._inversedConfig&&!b._firedKeys[b._inversedConfig[c]]&&(b._keys[b._inversedConfig[c]]=!0,b._firedKeys[b._inversedConfig[c]]=!0)}),document.addEventListener("keyup",function(a){var c=a.keyCode;c in b._inversedConfig&&(b._keys[b._inversedConfig[c]]=!1,b._firedKeys[b._inversedConfig[c]]=!1)}),b._currentKeys=function(){return this._keys},this._keys},b._resetKeys=function(){for(var a in this._keys)this._keys[a]=!1},b},f=function(){var a=new c(function(a){var b=this._positionValue();return a.position={x:b.x?b.x-this.elPos.left:b.x,y:b.y?b.y-this.elPos.top:b.y},a.actions=this._buttonsValue(),a},["position","buttons"]);return a._buttonsValue=function(){var a=this;this.el.addEventListener("mousedown",function(b){a._buttons={left:a._buttons.left||0===b.button,right:a._buttons.right||2===b.button}}),this._buttonsValue=function(){var a=this._buttons;return this._buttons={left:!1,right:!1},a},this._buttons={left:!1,right:!1}},a._positionValue=function(){var a=this;return this.el.addEventListener("mousemove",function(b){a._position={x:b.pageX,y:b.pageY}}),this.el.addEventListener("mouseout",function(){a._position={x:null,y:null}}),this._positionValue=function(){return this._position},this._position={x:null,y:null},this._position},a},g=new c(function(a){return a.time=Date.now(),a},["time"]),h=function(){var a=Date.now();return new c(function(b){var c=Date.now();return b.deltaTime=c-a,a=c,b},["deltaTime"])}(),i=function(a){var b=new c(function(a){return a.time=this._timeValue(),a},["time"]);return b._timeValue=function(){return this._el=function(b){var c=document.createElement("input");return c.setAttribute("type","range"),c.setAttribute("min","0"),c.setAttribute("max",a),c.addEventListener("change",function(){b._time=parseInt(this.value,10)}),document.body.appendChild(c),c.value=0,b._time=0,c}(this),this._timeValue=function(){return this._time},this._time},b};b.mouse=f,b.time=g,b.deltaTime=h,b.controlTime=i,b.keyboard=d,b.noAutoKeyboard=e}(window.Loop=window.Loop||{},window.Loop.io=window.Loop.io||{}),function(a,b){var c=function(){var a=document.createElement("div");return a.id="debugData",document.body.appendChild(a),{_out:a,_messages:[],_init:function(a,b,c){var d=this;if(c.debug){var e=c.debug;c.debug=function(a,b){e(a,b),d._messages.push([a,b])}}else c.debug=function(a,b){d._messages.push([a,b])}},animate:function(){return!0},render:function(){var a=this._messages.sort(function(a,b){return a[0].localeCompare(b[0])});this._out.innerHTML=a.reduce(function(a,b){return a+b[0]+" : "+b[1]+"<br/>"},""),this._messages=[]}}},d=function(){var a=document.createElement("div");a.id="debugGraph",document.body.appendChild(a);var b=["hsl(0, 66%, 30%)","hsl(40, 66%, 30%)","hsl(80, 66%, 30%)","hsl(120, 66%, 30%)","hsl(160, 66%, 30%)"];return{_messages:[],_dataSets:{},lastT:0,originalT:0,_init:function(a,b,c,d){var e=this;if(this.originalT=d.time,c.debug){var f=c.debug;c.debug=function(a,b){f(a,b),e._messages.push([a,b])}}else c.debug=function(a,b){e._messages.push([a,b])}},render:function(){if(window.jsPlot){var a=function(a){var c,d=[],e=0;for(c in a){var f=a[c],g=jsPlot.tools.datasetToFunc(f);g.color=b[e++%b.length],d.push(g)}return d}(this._dataSets),c=(this.lastT-this.originalT)/10,d=function(a,b){var c;for(c in a){var d=a[c],e=d[0][0];b>e&&(b=e)}return b}(this._dataSets,c);jsPlot("debugGraph",{Xmin:d,Xmax:c,Ymin:-10,Ymax:10,canvasHeight:250,canvasWidth:500,gridVisible:!1},a)}},animate:function(a){var b=this._dataSets;if(a.time>this.lastTime+1e3)return!0;var c=this.lastT-this.originalT;this.lastT=a.time;var d=this.asNumber;return this._messages.forEach(function(a){var e=a[0],f=d(a[1]);void 0!==f&&(b[e]||(b[e]=[]),b[e].length>=200&&b[e].shift(),b[e].push([c/10,f]))}),this._messages=[],!0},asNumber:function(a){if("number"==typeof a)return a;if("string"==typeof a)try{var b=parseFloat(a);return isNaN(b)?void 0:b}catch(c){return void 0}return void 0}}};b.debug=c,b.debugGraph=d}(window.Loop=window.Loop||{},window.Loop.tools=window.Loop.tools||{}),function(a,b){var c=function(){if(arguments.length<1)throw new Error("andThen must have at least one animation");var a=Array.prototype.slice.call(arguments,0);return{_init:function(b,c){this._loop=c,this._result=void 0,this._cachedOutputs=b,this.current=a.shift(),this.current._init.apply(this.current,arguments)},animate:function(b){if(void 0!==this._result){if(a.length<=0)return!1;this.current=a.shift(),this.current._init(this._cachedOutputs,this._loop,b,this._result),this._result=void 0}var c=this.current.animate.apply(this.current,arguments);if(!c){var d=function(a){return a.result&&"function"==typeof a.result?a.result():null}(this.current);this._result=d}return!0},render:function(){this.current.render.apply(this.current,arguments)},result:function(){return this._result}}},d=function(){if(arguments.length<1)throw new Error("all must have at least 1 animation");return{animations:Array.prototype.slice.call(arguments,0),_init:function(){var a=arguments;this._results=[],this.animations.forEach(function(b){b._init&&"function"==typeof b._init&&b._init.apply(b,a)})},render:function(){var a=arguments;this.animations.forEach(function(b){b.render.apply(b,a)})},animate:function(){var a=arguments,b=this;return this.animations=this.animations.reduce(function(c,d){var e=d.animate.apply(d,a);return e?c.push(d):d.result&&b._results.push(d.result()),c},[]),this.animations.length>0},result:function(){return this._results.filter(function(a){return!!a}).reduce(function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},{})}}},e=function(){var a=d.apply(window,arguments),b=function(){var a=arguments,b=this;return this.animations=this.animations.reduce(function(c,d){var e=d.animate.apply(d,a);return e?c.push(d):b._results=b.animations.map(function(a){return a.result?a.result():{}}),c},[]),0===this._results.length};return a.animate=b.bind(a),a},f=function(a,b){return{_init:function(){this._initArgs=arguments,this.initSubAnimation()},animate:function(){var a=this._anim.animate.apply(this._anim,arguments);if(!a){var c=b(this._anim.result());if(c)return!1;this.initSubAnimation()}return!0},render:function(){this._anim.render.apply(this._anim,arguments)},result:function(){return this._anim.result.apply(this._anim)},initSubAnimation:function(){this._anim=a(),this._anim._init.apply(this._anim,this._initArgs)}}},g=function(a){return f(a,function(){return!1})};b.andThen=c,b.all=d,b.some=e,b.until=f,b.while1=g}(window.Loop=window.Loop||{},window.Loop.meta=window.Loop.meta||{}),function(a,b){function c(a,b){if(arguments.length<2)throw new Error("Not enough arguments to build OutputManager",this);var c=arguments.length>2?Array.prototype.splice.call(arguments,2):[];this.name=a,this.context=null,this._initCtx=b,this._params=c}c.prototype={_init:function(a){var b=this._initCtx.apply(this,this._params);return b.onRenderStart&&a.on("renderStart",b.onRenderStart),b.onRenderEnd&&a.on("renderEnd",b.onRenderEnd),{context:b.ctx,parameters:b.parameters}}};var d=c.bind(null,"canvas2d",function(a,b,c,d){var e=document.createElement("canvas");e.height=c,e.width=b;var f=document.createElement("canvas");f.height=c,f.width=b;var g=e.getContext("2d"),h=e.getContext("2d");a.appendChild(e);var i=d?d.bind(this,h,b,c):function(){h.globalCompositeOperation="source-over",h.fillStyle="#000000",h.fillRect(0,0,b,c)};return{ctx:h,parameters:{height:c,width:b,canvas:e},onRenderStart:i,onRenderEnd:function(){g.drawImage(f,0,0)}}}),e=c.bind(null,"webaudio",function(){var a=window.AudioContext||window.webkitAudioContext,b=new a;return{ctx:b}});b.canvas2d=d,b.webaudio=e}(window.Loop=window.Loop||{},window.Loop.out=window.Loop.out||{}),function(a,b){function c(a){this.render=a}var d={circle:function(a,b){var c=b.canvas2d.context,d=a.size/2;this.particleCanvas||(this.particleCanvas=function(){var b=document.createElement("canvas"),c=b.getContext("2d");return b.width=a.size,b.height=a.size,c.fillStyle=a.color,c.beginPath(),c.arc(d,d,d,0,2*Math.PI,!0),c.closePath(),c.fill(),b}()),c.globalCompositeOperation=a.compositionMethod;for(var e=0;e<this.particles.length;e++){var f=this.particles[e];c.drawImage(this.particleCanvas,~~(f[0]-d),~~(f[1]-d))}},texture:function(a,b){for(var c=b.canvas2d.context,d=0;d<this.particles.length;d++){var e=this.particles[d];c.drawImage(a.img,~~e[0],~~e[1])}},line:function(a,b){var c=b.canvas2d.context;if(0!==this.particles.length){c.globalCompositeOperation=a.compositionMethod,c.beginPath(),c.strokeStyle=a.color,c.moveTo(~~this.particles[0][0],~~this.particles[0][1]);for(var d=1;d<this.particles.length;d++){var e=this.particles[d];c.lineTo(~~e[0],~~e[1])}c.stroke()}},quadratic:function(a,b){var c=b.canvas2d.context;if(0!==this.particles.length){c.globalCompositeOperation=a.compositionMethod,c.beginPath(),c.strokeStyle=a.color,c.moveTo(~~this.particles[0][0],~~this.particles[0][1]);for(var d=1;d<this.particles.length;d++){var e=this.particles[d];c.quadraticCurveTo(e[0]-100*e[3],e[1]-100*e[4],~~e[0],~~e[1])}c.stroke()}},imageData:function(a,b){for(var c=b.canvas2d.context,d=c.getImageData(0,0,this.width,this.height),e=d.data,f=1;f<this.particles.length;f++){var g=this.particles[f],h=~~g[0],i=~~g[1],j=4*(h+i*this.width);e[j]=250,e[j+1]=250,e[j+2]=2,e[j+3]=255}c.putImageData(d,0,0)}};c.prototype={createField:function(a,b,c,d,e){var f=e||function(){},g={_init:function(b){var c=b.canvas2d.parameters;this.width=w=c.width,this.height=h=c.height,this.particles=a?a(w,h):[],this.toBeCreated=[]},animate:function(a){this.toBeCreated.forEach(function(b){this._create(a,b)},this),this.toBeCreated=[];for(var b=0;b<this.particles.length;b++){var d=this.particles[b],e=a.time;c(d,this.particles,this.width,this.height,a),d[0]=d[0]+d[3],d[1]=d[1]+d[4],(d[0]>this.width+500||d[1]>this.height+500||d[0]<-500||d[1]<-500||d[2]<e)&&(f(d),this.particles.splice(b,1))}return!0},create:function(a){this.toBeCreated.push(a)},_create:function(a,b){Date.now();for(var c=0;b>c;c++)this.particles.push(this._createParticlef(a,this.width,this.height))},getParticleCount:function(){return this.particles.length}};return g.render=this.render.bind(g,d),g._createParticlef=b,g}};var e=new c(d.circle),f=new c(d.line),g=new c(d.quadratic),i=new c(d.texture),j=new c(d.imageData);b.circle=e.createField.bind(e),b.lasso=f.createField.bind(f),b.lasso2=g.createField.bind(g),b.texture=i.createField.bind(i),b.imageData=j.createField.bind(j)}(window.Loop=window.Loop||{},window.Loop.particles=window.Loop.particles={}),function(a,b){var c=function(){return{_init:function(a,b,c,d,e){this.img=e["title.png"],this.start=d.time,this.resources=e},render:function(a){a.drawImage(this.img,0,0)},animate:function(a){return a.time-this.start<1e3},result:function(){return this.resources}}};b.intro=c}(window.Loop=window.Loop||{},window.Loop.sprite=window.Loop.sprite||{}),function(a,b){var c=function(a,b){return{_init:function(a,b,c){console.log(c.time),this.startTime=c.time},animate:function(a){return a.time<this.startTime+b},render:function(b){var c=b.canvas2d.context,d=b.canvas2d.parameters.width,e=b.canvas2d.parameters.height,f=c.measureText(a);c.fillStyle="white",c.fillText(a,d/2-f.width/2,e/2)}}},d=function(a){var b="loading";return{resources:a,loaded:{},totalLoad:0,total:0,_init:function(b){if(a.data&&(this.total+=a.data.length,a.data.forEach(function(a){var b=new XMLHttpRequest,c=this;b.addEventListener("load",function(){c.loaded[a]=JSON.parse(this.response),c.totalLoad++}),b.open("GET",a,!0),b.send()},this)),a.img&&(this.total+=a.img.length,a.img.forEach(function(a){var b=document.createElement("img"),c=this;b.addEventListener("load",function(){c.loaded[a]=b,c.totalLoad++}),b.src=a},this)),a.sfx){var c=b.webaudio.context,d=this;this.total+=a.sfx.length,a.sfx.forEach(function(a){var b=new XMLHttpRequest;b.addEventListener("load",function(){c.decodeAudioData(b.response,function(b){d.loaded[a]=b,d.totalLoad++})}),b.open("GET",a,!0),b.responseType="arraybuffer",b.send()})}},animate:function(){return this.total>this.totalLoad},render:function(a){var c=a.canvas2d.context,d=a.canvas2d.parameters.width,e=a.canvas2d.parameters.height,f=c.measureText(b);c.fillStyle="white",c.fillText(b,d/2-f.width/2,e/2)},result:function(){return this.loaded}}};b.simple=c,b.loading=d}(window.Loop=window.Loop||{},window.Loop.text=window.Loop.text||{});